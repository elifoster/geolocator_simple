#!/usr/bin/env ruby
# encoding: utf-8

path = File.expand_path('../lib', __FILE__)
$LOAD_PATH.unshift(path)

require 'rainbow'
require 'string-utility'
require_relative '../lib/simple_geolocator'

if ARGV.empty?
  fail 'You must provide an IP.'
end

ip = ARGV[0]
response = SimpleGeolocator.get(ip)
city = response.city
region = response.region.name
country = response.country.name
zip = response.zip
ll = response.ll
timezone = response.timezone
isp = response.isp
org = response.organization
mobile = response.mobile?
proxy = response.proxy?

puts "Here is the data for #{ip}:"
puts Rainbow("ISP: #{isp}").color(StringUtility.random_color_six)
puts Rainbow("Organization: #{org}").color(StringUtility.random_color_six)
puts Rainbow("Timezone: #{timezone}").color(StringUtility.random_color_six)
puts Rainbow("Location: #{city}, #{region}, #{country}, #{zip}").color(StringUtility.random_color_six)
puts Rainbow("Exact location: #{ll.left}, #{ll.right}").color(StringUtility.random_color_six)
puts Rainbow('They are using a mobile connection.').color(StringUtility.random_color_six) if mobile
puts Rainbow('They are using a proxy.').color(StringUtility.random_color_six) if proxy
